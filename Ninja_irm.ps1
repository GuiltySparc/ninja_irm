
# define list of companies and their NinjaRMM URLs for installer download
$ninja = @{

    "1" = @{ Name = "3D Big"; Url = "https://app.ninjarmm.com/agent/installer/2a40eefd-5c86-44d1-933c-b51f5af5d045/3dbigmainoffice-8.0.2891-windows-installer.msi" }
    "2" = @{ Name = "ALM Technologies"; Url = "https://app.ninjarmm.com/agent/installer/01a188a4-df6a-4678-9529-a73ddc1108ab/almtechnologiesmainoffice-8.0.2891-windows-installer.msi"}
    "3" = @{ Name = "Ancient City Title"; Url = "https://app.ninjarmm.com/agent/installer/39ea50b3-cf1f-4dbe-a9fd-5a2318b673a1/ancientcitytitlemainoffice-8.0.2891-windows-installer.msi"}
    "4" = @{ Name = "ANE Lending"; Url = "https://app.ninjarmm.com/agent/installer/08216002-a262-4d4a-8910-c345ec75e23d/anelendingmainoffice-8.0.2891-windows-installer.msi"}
    "5" = @{ Name = "ASAP"; Url = "https://app.ninjarmm.com/agent/installer/dd9e14d7-59f6-46d0-8eb0-b9e604e86422/asaptowingandstoragemainoffice-8.0.2891-windows-installer.msi"}
    "6" = @{ Name = "BHRS"; Url = "https://app.ninjarmm.com/agent/installer/3c0d0fbd-7845-440c-aa9d-bdd4afd9db3e/bhrscompaniesmainoffice-8.0.2891-windows-installer.msi"}
    "7" = @{ Name = "Butler Enterprises"; Url = "https://app.ninjarmm.com/agent/installer/7cec66d1-d533-406c-8c8c-09d4ad7584fb/butlerenterprisesmainoffice-8.0.2891-windows-installer.msi"}
    "8" = @{ Name = "Coastal Cosmetic Center"; Url = "https://app.ninjarmm.com/agent/installer/3c27eabd-b59c-485e-ae0a-ebd60c8af147/coastalcosmeticcentermainoffice-8.0.2891-windows-installer.msi"}
    "9" = @{ Name = "Cook Electrical"; Url = "https://app.ninjarmm.com/agent/installer/71019578-9272-4c00-8c64-59196f72fce3/cookelectricalmainoffice-8.0.2891-windows-installer.msi"}
    "10" = @{ Name = "Coyle Jax"; Url = "https://app.ninjarmm.com/agent/installer/7accbe67-c6f0-4d6f-80ae-46030734a12c/coylejaxmainoffice-8.0.2891-windows-installer.msi"}
    "11" = @{ Name = "Dostie Homes"; Url = "https://app.ninjarmm.com/agent/installer/7d31c712-c75b-4935-92ce-793283b3d6fd/dostiehomesmainoffice-8.0.2891-windows-installer.msi"}
    "12" = @{ Name = "First Coast Dermatology"; Url = "https://app.ninjarmm.com/agent/installer/dacef3a2-60b8-4bb1-b3fb-e60ff1b59dd8/firstcoastdermatologymainoffice-8.0.2891-windows-installer.msi"}
    "13" = @{ Name = "Gateway Business Advisors"; Url = "https://app.ninjarmm.com/agent/installer/ea0eeaa9-f709-44ba-8db8-eb627462cfc4/gatewaybusinessadvisorsmainoffice-8.0.2891-windows-installer.msi"}
    "14" = @{ Name = "Gator Bowl Sports"; Url = "https://app.ninjarmm.com/agent/installer/8d0d8683-a449-4d30-bc77-97dac50d7881/gatorbowlsportsmainoffice-8.0.2891-windows-installer.msi"}
    "15" = @{ Name = "Gene 2 Genome"; Url = "https://app.ninjarmm.com/agent/installer/2e5ad2e7-261b-4410-b4a2-412603588886/gene2genomemainoffice-8.0.2891-windows-installer.msi"}
    "16" = @{ Name = "GP Marketing"; Url = "https://app.ninjarmm.com/agent/installer/eb3b985a-2c31-4837-98df-156700d89e8e/gpmarketingmainoffice-8.0.2891-windows-installer.msi"}
    "17" = @{ Name = "Harbor View Title"; Url = "https://app.ninjarmm.com/agent/installer/770266c8-4473-40fe-b644-44e3f20a1422/harborviewtitlemainoffice-8.0.2891-windows-installer.msi"}
    "18" = @{ Name = "Harrod Law"; Url = "https://app.ninjarmm.com/agent/installer/6cf02538-d8cc-46d5-a8ea-4002dcddfe9d/harrodlawmainoffice-8.0.2891-windows-installer.msi"}
    "19" = @{ Name = "Houser Law Firm"; Url = "https://app.ninjarmm.com/agent/installer/0705cf7e-cef7-4d37-9ca8-ed01003ccece/houserlawfirmmainoffice-8.0.2891-windows-installer.msi"}
    "20" = @{ Name = "Housing Design Matters"; Url = "https://app.ninjarmm.com/agent/installer/96996f71-69d5-4acc-a0b9-59b5e186011d/housingdesignmattersmainoffice-8.0.2891-windows-installer.msi"}
    "21" = @{ Name = "HTI"; Url = "https://app.ninjarmm.com/agent/installer/2068a43e-6874-42bf-a564-e0adc2345aac/htimainoffice-8.0.2891-windows-installer.msi"}
    "22" = @{ Name = "Jacksonville ENT Surgery"; Url = "https://app.ninjarmm.com/agent/installer/6f22c0e1-0680-4948-a003-6bfced483650/jacksonvilleentsurgerymainoffice-8.0.2891-windows-installer.msi"}
    "23" = @{ Name = "Jacksonville Flower Market"; Url = "https://app.ninjarmm.com/agent/installer/95aff5d5-bd5d-469b-b40a-1c987791b977/jacksonvilleflowermarketmainoffice-8.0.2891-windows-installer.msi"}
    "24" = @{ Name = "Kendale Design Build"; Url = "https://app.ninjarmm.com/agent/installer/1dc59340-48ef-4c6c-a086-452f9600ccd7/kendaledesignbuildmainoffice-8.0.2891-windows-installer.msi"}
    "25" = @{ Name = "Lofty Asset Management"; Url = "https://app.ninjarmm.com/agent/installer/b3922c19-59b2-49ba-a0a6-79105986d17a/loftyassetmanagementcarolinesquare-8.0.2891-windows-installer.msi"}
    "26" = @{ Name = "Marchand Faries Financial Management"; Url = "https://app.ninjarmm.com/agent/installer/b9c18aad-51b1-4352-bed3-e703945ef477/marchandfariesfinancialmanagementmainoffice-8.0.2891-windows-installer.msi"}
    "27" = @{ Name = "McGowan Spinal Rehabilitation Center"; Url = "https://app.ninjarmm.com/agent/installer/01729969-11c1-4e5d-b196-070b008a144b/mcgowanspinalrehabilitationcentermainoffice-8.0.2891-windows-installer.msi"}
    "28" = @{ Name = "Money Pages"; Url = "https://app.ninjarmm.com/agent/installer/4ae494fa-daaa-4a16-9422-633aecb1ea7a/moneypagesmainoffice-8.0.2891-windows-installer.msi"}
    "29" = @{ Name = "Norman Law"; Url = "https://app.ninjarmm.com/agent/installer/1abde665-d283-4f5a-a5f7-2d0f788a4df7/normanlawmainoffice-8.0.2891-windows-installer.msi"}
    "30" = @{ Name = "North Florida Sales"; Url = "https://app.ninjarmm.com/agent/installer/c6856107-b525-455d-bf62-948e989a4c45/northfloridasalesmainoffice-8.0.2891-windows-installer.msi"}
    "31" = @{ Name = "Northeast Florida AHEC"; Url = "https://app.ninjarmm.com/agent/installer/f848f862-ab6b-48d7-b1c9-45d173612e2f/northeastfloridaahecmainoffice-8.0.2891-windows-installer.msi"}
    "32" = @{ Name = "Peoplr"; Url = "https://app.ninjarmm.com/agent/installer/bc24641f-f7c5-461f-96cb-3c53a2c92b75/peoplrmainoffice-8.0.2891-windows-installer.msi"}
    "33" = @{ Name = "Pinspiration"; Url = "https://app.ninjarmm.com/agent/installer/b97971e0-0472-415e-92bd-88152e17b96a/pinspirationmainoffice-8.0.2891-windows-installer.msi"}
    "34" = @{ Name = "Reliox Corporation"; Url = "https://app.ninjarmm.com/agent/installer/eed52773-83d1-41c6-94fd-a9532d3ef7cd/relioxcorporationmainoffice-8.0.2891-windows-installer.msi"}
    "35" = @{ Name = "River City Title"; Url = "https://app.ninjarmm.com/agent/installer/3439c23e-b709-4f05-82f9-0d3e679e6249/rivercitytitlemainoffice-8.0.2891-windows-installer.msi"}
    "36" = @{ Name = "Sawyer & Sawyer PA"; Url = "https://app.ninjarmm.com/agent/installer/284e9e35-e34a-44c5-988b-f50a4a2e55d9/sawyerandsawyerpamainoffice-8.0.2891-windows-installer.msi"}
    "37" = @{ Name = "Schuman Electric"; Url = "https://app.ninjarmm.com/agent/installer/15f0a18d-c5f1-4383-96ab-00b34f5e660e/schumanelectricmainoffice-8.0.2891-windows-installer.msi"}
    "38" = @{ Name = "Snap.Build"; Url = "https://app.ninjarmm.com/agent/installer/92bd82c2-2c74-4936-acf3-e937b05319b9/snapbuildmainoffice-8.0.2891-windows-installer.msi"}
    "39" = @{ Name = "USMHE"; Url = "https://app.ninjarmm.com/agent/installer/60cb6a6a-c010-4fb6-b68a-e0a7d1d112ed/usmobilehealthexamsmainoffice-8.0.2891-windows-installer.msi"}
    "40" = @{ Name = "US Patriot Title"; Url = "https://app.ninjarmm.com/agent/installer/64d73b3d-0d29-48e3-a855-3eef8e3ef5aa/uspatriottitlemainoffice-8.0.2891-windows-installer.msi"}

}

# display list of available companies
Write-Host "`nAvailable companies:"
$ninja.Keys | Sort-Object { [int]$_ }| ForEach-Object {
    Write-Host "$_) $($ninja[$_].Name)"
}

# prompt user to select desired company file
$companyNumber = Read-Host "`nEnter the associated number for the installer you need:"

# Validate the selection
if ($ninja.ContainsKey($companyNumber)) {
    $selectedCompany = $ninja[$companyNumber]
    Write-Host "`nYou selected: $($selectedCompany.Name)"

    # Confirm the selection
    $confirmation = Read-Host "Are you sure this is the company? (Y/N)"

    if ($confirmation -match "^[Yy]$") {

        Write-Host "`nDownloading $($selectedCompany.Name) from $($selectedCompany.Url)..."

        try {
            # Download the file
            Start-Process $selectedCompany.Url -ErrorAction Stop
            Write-Host "✅ Download complete!"
        }
        catch {
            Write-Host "❌ Error: Could not download the file. Check the URL or your connection."
        }
    }
    else {
        Write-Host "⛔ Download cancelled."
    }
}
else {
    Write-Host "❌ Invalid selection. Please choose a valid number from the list."
}